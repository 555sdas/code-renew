E:\liner\venv_dmge\Scripts\python.exe E:\徐兵鑫毕业论文\code-renew\experiments\v4_model_信息熵优化.py
=== 数据集fourclass ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\fourclass\fourclass.csv

=== 数据集详细信息 ===
总样本数: 862
特征数: 2

=== 标签分布 ===
label
-1.0    555
 1.0    307
Name: count, dtype: int64

=== 特征统计 ===
                0           1
count  862.000000  862.000000
mean   100.061485  101.955916
std     48.988109   48.114608
min      8.000000   16.000000
25%     59.250000   58.000000
50%     99.000000  102.000000
75%    140.000000  145.000000
max    190.000000  187.000000
=== 开始训练 ===
[GranularBall] 初始化参数: max_entropy=0.9, min_samples=3, shrink_factor=0.1
[Classifier] 初始化: alpha=1, beta=0.001

=== 数据检查 ===
样本数: 603, 特征数: 2
类别分布: (array([0, 1], dtype=int64), array([388, 215], dtype=int64))
[Entropy] 计算: 原始熵=0.940, 归一化熵=0.940, 类别数=2
全局熵: 0.940


=== 迭代 1 ===
当前粒球: 样本数=603, 层级=0
[Center] 计算: 中心点=[-0.04272793 -0.02610744], 半径=1.805, 密度=58.936
[Shrink] 收缩前: 半径=1.805, 密度=47.110, 因子=0.700
[Shrink] 收缩后: 新半径=1.263, 保留样本=269/482
[Entropy] 计算: 原始熵=0.927, 归一化熵=0.927, 类别数=2
[SplitCheck] 熵=0.927, 阈值=0.9, 平均半径=1.000
[Entropy] 计算: 原始熵=0.927, 归一化熵=0.927, 类别数=2
[Split] 正在分裂: 样本数=269, 熵=0.927, 簇数=3
[Split] 分裂为3个子粒球
[Outer] 发现外部样本: 121个

=== 迭代 2 ===
当前粒球: 样本数=82, 层级=1
[Center] 计算: 中心点=[0.24560874 0.71118656], 半径=0.602, 密度=72.034
[Shrink] 收缩前: 半径=0.602, 密度=57.100, 因子=0.700
[Shrink] 收缩后: 新半径=0.421, 保留样本=42/65
[Entropy] 计算: 原始熵=0.993, 归一化熵=0.993, 类别数=2
[SplitCheck] 熵=0.993, 阈值=0.9, 平均半径=1.000
[Entropy] 计算: 原始熵=0.993, 归一化熵=0.993, 类别数=2
[Split] 正在分裂: 样本数=42, 熵=0.993, 簇数=3
[Split] 分裂为3个子粒球
[Outer] 发现外部样本: 17个

=== 迭代 3 ===
当前粒球: 样本数=105, 层级=1
[Center] 计算: 中心点=[-0.00153698 -0.69071048], 半径=0.683, 密度=71.693
[Shrink] 收缩前: 半径=0.683, 密度=57.355, 因子=0.700
[Shrink] 收缩后: 新半径=0.478, 保留样本=39/84
[Entropy] 计算: 原始熵=0.779, 归一化熵=0.779, 类别数=2
[SplitCheck] 熵=0.779, 阈值=0.9, 平均半径=1.000
[Entropy] 计算: 原始熵=0.779, 归一化熵=0.779, 类别数=2
[Ball] 新增粒球: 中心=[-0.00153698 -0.69071048], 半径=0.478, 样本数=39, 熵=0.779
[Outer] 发现外部样本: 21个

=== 迭代 4 ===
当前粒球: 样本数=82, 层级=1
[Center] 计算: 中心点=[-0.80476054  0.08812121], 半径=0.604, 密度=71.570
[Shrink] 收缩前: 半径=0.604, 密度=56.733, 因子=0.700
[Shrink] 收缩后: 新半径=0.423, 保留样本=35/65
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.478
[Ball] 新增粒球: 中心=[-0.80476054  0.08812121], 半径=0.423, 样本数=35, 熵=0.000
[Outer] 发现外部样本: 17个

=== 迭代 5 ===
当前粒球: 样本数=121, 层级=1
[Center] 计算: 中心点=[1.13121421 1.03310366], 半径=2.776, 密度=4.999
[Shrink] 收缩前: 半径=2.776, 密度=4.007, 因子=0.700
[Shrink] 收缩后: 新半径=1.943, 保留样本=45/97
[Entropy] 计算: 原始熵=0.433, 归一化熵=0.433, 类别数=2
[SplitCheck] 熵=0.433, 阈值=0.9, 平均半径=0.450
[Entropy] 计算: 原始熵=0.433, 归一化熵=0.433, 类别数=2
[Ball] 新增粒球: 中心=[1.13121421 1.03310366], 半径=1.943, 样本数=45, 熵=0.433
[Outer] 发现外部样本: 24个

=== 迭代 6 ===
当前粒球: 样本数=18, 层级=2
[Center] 计算: 中心点=[-0.04272793  0.68003329], 半径=0.244, 密度=96.077
[Shrink] 收缩前: 半径=0.244, 密度=74.726, 因子=0.700
[Shrink] 收缩后: 新半径=0.171, 保留样本=12/14
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.948
[Ball] 新增粒球: 中心=[-0.04272793  0.68003329], 半径=0.171, 样本数=12, 熵=0.000
[Outer] 发现外部样本: 4个

=== 迭代 7 ===
当前粒球: 样本数=14, 层级=2
[Center] 计算: 中心点=[0.43096802 0.91887501], 半径=0.163, 密度=167.683
[Shrink] 收缩前: 半径=0.163, 密度=131.751, 因子=0.700
[Shrink] 收缩后: 新半径=0.114, 保留样本=6/11
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.754
[Ball] 新增粒球: 中心=[0.43096802 0.91887501], 半径=0.114, 样本数=6, 熵=0.000
[Outer] 发现外部样本: 3个

=== 迭代 8 ===
当前粒球: 样本数=10, 层级=2
[Center] 计算: 中心点=[0.3176929  0.46196042], 半径=0.235, 密度=57.698
[Shrink] 收缩前: 半径=0.235, 密度=46.158, 因子=0.700
[Shrink] 收缩后: 新半径=0.164, 保留样本=2/8
[Ball] 新增粒球: 中心=[0.3176929  0.46196042], 半径=0.164, 样本数=2, 熵=0.000
[Outer] 发现外部样本: 2个
[Center] 计算: 中心点=[0.04995171 0.44119158], 半径=0.044, 密度=330.554
[SmallBall] 新增小粒球: 样本数=2, 熵=0.000

=== 迭代 9 ===
当前粒球: 样本数=17, 层级=2
[Center] 计算: 中心点=[-0.10451436  0.68003329], 半径=1.005, 密度=5.362
[Shrink] 收缩前: 半径=1.005, 密度=4.100, 因子=0.700
[Shrink] 收缩后: 新半径=0.703, 保留样本=9/13
[Entropy] 计算: 原始熵=0.991, 归一化熵=0.991, 类别数=2
[SplitCheck] 熵=0.991, 阈值=0.9, 平均半径=0.477
[Entropy] 计算: 原始熵=0.991, 归一化熵=0.991, 类别数=2
[Split] 正在分裂: 样本数=9, 熵=0.991, 簇数=3
[Split] 分裂为3个子粒球
[Outer] 发现外部样本: 4个

=== 迭代 10 ===
当前粒球: 样本数=21, 层级=2
[Center] 计算: 中心点=[ 0.61632731 -0.33764011], 半径=1.423, 密度=3.300
[Shrink] 收缩前: 半径=1.423, 密度=2.671, 因子=0.733
[Shrink] 收缩后: 新半径=1.043, 保留样本=14/17
[Entropy] 计算: 原始熵=0.592, 归一化熵=0.592, 类别数=2
[SplitCheck] 熵=0.592, 阈值=0.9, 平均半径=0.477
[Entropy] 计算: 原始熵=0.592, 归一化熵=0.592, 类别数=2
[Ball] 新增粒球: 中心=[ 0.61632731 -0.33764011], 半径=1.043, 样本数=14, 熵=0.592
[Outer] 发现外部样本: 4个

=== 迭代 11 ===
当前粒球: 样本数=17, 层级=2
[Center] 计算: 中心点=[-0.76356959  0.72157099], 半径=1.167, 密度=3.972
[Shrink] 收缩前: 半径=1.167, 密度=3.038, 因子=0.700
[Shrink] 收缩后: 新半径=0.817, 保留样本=11/13
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.548
[Ball] 新增粒球: 中心=[-0.76356959  0.72157099], 半径=0.817, 样本数=11, 熵=0.000
[Outer] 发现外部样本: 4个

=== 迭代 12 ===
当前粒球: 样本数=24, 层级=2
[Center] 计算: 中心点=[-1.64917507  0.451576  ], 半径=1.886, 密度=2.147
[Shrink] 收缩前: 半径=1.886, 密度=1.700, 因子=0.830
[Shrink] 收缩后: 新半径=1.566, 保留样本=16/19
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.577
[Ball] 新增粒球: 中心=[-1.64917507  0.451576  ], 半径=1.566, 样本数=16, 熵=0.000
[Outer] 发现外部样本: 5个

=== 迭代 13 ===
当前粒球: 样本数=4, 层级=3
[Center] 计算: 中心点=[0.04995171 0.90849059], 半径=0.125, 密度=81.109
[Shrink] 收缩前: 半径=0.125, 密度=60.832, 因子=0.700
[Shrink] 收缩后: 新半径=0.088, 保留样本=0/3
[WARNING] 收缩后粒球样本数为0，跳过添加
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[-0.0633234   0.99156597], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 迭代 14 ===
当前粒球: 样本数=3, 层级=3
[Center] 计算: 中心点=[0.32799064 1.0954102 ], 半径=0.229, 密度=18.204
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[0.61632731 0.8669529 ], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 迭代 15 ===
当前粒球: 样本数=4, 层级=3
[Center] 计算: 中心点=[-0.47523293  0.85656848], 半径=0.083, 密度=185.088
[Shrink] 收缩前: 半径=0.083, 密度=138.816, 因子=0.700
[Shrink] 收缩后: 新半径=0.058, 保留样本=3/3
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.564
[Ball] 新增粒球: 中心=[-0.47523293  0.85656848], 半径=0.058, 样本数=3, 熵=0.000
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[-0.53701936  0.97079713], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 迭代 16 ===
当前粒球: 样本数=4, 层级=3
[Center] 计算: 中心点=[-0.28987364  1.16810115], 半径=0.134, 密度=70.464
[Shrink] 收缩前: 半径=0.134, 密度=52.848, 因子=0.700
[Shrink] 收缩后: 新半径=0.094, 保留样本=2/3
[Ball] 新增粒球: 中心=[-0.28987364  1.16810115], 半径=0.094, 样本数=2, 熵=0.000
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[-0.10451436  1.22002327], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 迭代 17 ===
当前粒球: 样本数=1, 层级=3
[Center] 计算: 中心点=[-0.4134465   0.68003329], 半径=0.000, 密度=318309.886

=== 迭代 18 ===
当前粒球: 样本数=4, 层级=3
[Center] 计算: 中心点=[0.79138885 0.08812121], 半径=0.347, 密度=10.558
[Shrink] 收缩前: 半径=0.347, 密度=7.918, 因子=0.700
[Shrink] 收缩后: 新半径=0.243, 保留样本=3/3
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.432
[Ball] 新增粒球: 中心=[0.79138885 0.08812121], 半径=0.243, 样本数=3, 熵=0.000
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[0.9664504  0.65926445], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 迭代 19 ===
当前粒球: 样本数=4, 层级=3
[Center] 计算: 中心点=[-0.74297412 -0.98147431], 半径=0.154, 密度=53.641
[Shrink] 收缩前: 半径=0.154, 密度=40.231, 因子=0.700
[Shrink] 收缩后: 新半径=0.108, 保留样本=3/3
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.398
[Ball] 新增粒球: 中心=[-0.74297412 -0.98147431], 半径=0.108, 样本数=3, 熵=0.000
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[-0.78416507 -0.71147932], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 迭代 20 ===
当前粒球: 样本数=4, 层级=3
[Center] 计算: 中心点=[-0.89744019 -0.58686625], 半径=0.264, 密度=18.205
[Shrink] 收缩前: 半径=0.264, 密度=13.654, 因子=0.700
[Shrink] 收缩后: 新半径=0.185, 保留样本=3/3
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.363
[Ball] 新增粒球: 中心=[-0.89744019 -0.58686625], 半径=0.185, 样本数=3, 熵=0.000
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[-1.25786102 -0.33764011], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 迭代 21 ===
当前粒球: 样本数=5, 层级=3
[Center] 计算: 中心点=[ 1.21359612 -1.72915273], 半径=2.401, 密度=0.276
[Shrink] 收缩前: 半径=2.401, 密度=0.221, 因子=0.978
[Shrink] 收缩后: 新半径=2.348, 保留样本=3/4
[SplitCheck] 熵=0.000, 阈值=0.9, 平均半径=0.339
[Ball] 新增粒球: 中心=[ 1.21359612 -1.72915273], 半径=2.348, 样本数=3, 熵=0.000
[Outer] 发现外部样本: 1个
[Center] 计算: 中心点=[-1.34024292 -1.45915775], 半径=0.000, 密度=318309.886
[SmallBall] 新增小粒球: 样本数=1, 熵=0.000

=== 训练完成 ===
生成粒球数: 24
平均半径: 0.408
平均熵: 0.075
覆盖样本数: 207/603
[Entropy] 计算: 原始熵=0.592, 归一化熵=0.592, 类别数=2
[Entropy] 计算: 原始熵=0.433, 归一化熵=0.433, 类别数=2
[Entropy] 计算: 原始熵=0.779, 归一化熵=0.779, 类别数=2
Ensemble model trained successfully

=== 训练后模型结构 ===
GranularThreeWayClassifier V4 (信息熵优化) 模型结构:
- 粒球模型: GranularBallV4
  * 最大熵阈值: 0.9
  * 半径收缩因子: 0.1
  * 粒球数量: 24
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.001
- 集成分类器: VotingClassifier
- 粒球统计:
  * 平均熵: 0.08
  * 平均密度: 106151.13

=== 特征重要性 ===
[0.49503623 0.50496377]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.4556
精确率: 0.2574
召回率: 0.2826
F1分数: 0.2694

=== 三支决策分布 ===
接受区域: 37.5%
拒绝区域: 47.1%
延迟决策: 15.4%
延迟决策准确率: 0.3750

混淆矩阵:
[[92 75]
 [66 26]]

进程已结束，退出代码为 0
