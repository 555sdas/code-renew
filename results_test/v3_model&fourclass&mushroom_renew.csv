E:\liner\venv_dmge\Scripts\python.exe E:\徐兵鑫毕业论文\code-renew\experiments\v3_model_自适应论文方法.py
=== 数据集fourclass ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\fourclass\fourclass.csv

=== 数据集详细信息 ===
总样本数: 862
特征数: 2

=== 标签分布 ===
label
-1.0    555
 1.0    307
Name: count, dtype: int64

=== 特征统计 ===
                0           1
count  862.000000  862.000000
mean   100.061485  101.955916
std     48.988109   48.114608
min      8.000000   16.000000
25%     59.250000   58.000000
50%     99.000000  102.000000
75%    140.000000  145.000000
max    190.000000  187.000000
=== 开始训练 ===

初始数据统计: 样本数=603, 类别分布={0: 388, 1: 215}
处理粒球: 层级=0, 样本数=603, 纯度=0.64, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=1, 样本数=306, 纯度=0.55, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=1, 样本数=297, 纯度=0.74, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=2, 样本数=126, 纯度=0.80, 实际阈值=0.79
处理粒球: 层级=2, 样本数=180, 纯度=0.79, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=2, 样本数=162, 纯度=0.56, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=2, 样本数=135, 纯度=0.96, 实际阈值=0.79
处理粒球: 层级=3, 样本数=80, 纯度=0.94, 实际阈值=0.79
处理粒球: 层级=3, 样本数=100, 纯度=0.67, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=3, 样本数=68, 纯度=0.60, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=3, 样本数=94, 纯度=0.53, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=4, 样本数=36, 纯度=0.81, 实际阈值=0.79
处理粒球: 层级=4, 样本数=64, 纯度=0.59, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=4, 样本数=30, 纯度=0.80, 实际阈值=0.79
处理粒球: 层级=4, 样本数=38, 纯度=0.92, 实际阈值=0.79
处理粒球: 层级=4, 样本数=33, 纯度=1.00, 实际阈值=0.79
处理粒球: 层级=4, 样本数=61, 纯度=0.72, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=5, 样本数=31, 纯度=0.65, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=5, 样本数=33, 纯度=0.55, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=5, 样本数=19, 纯度=1.00, 实际阈值=0.79
处理粒球: 层级=5, 样本数=42, 纯度=0.60, 实际阈值=0.79
--> 触发分裂
处理粒球: 层级=6, 样本数=11, 纯度=1.00, 实际阈值=0.79
处理粒球: 层级=6, 样本数=20, 纯度=1.00, 实际阈值=0.79
处理粒球: 层级=6, 样本数=18, 纯度=1.00, 实际阈值=0.79
处理粒球: 层级=6, 样本数=15, 纯度=1.00, 实际阈值=0.79
处理粒球: 层级=6, 样本数=25, 纯度=1.00, 实际阈值=0.79
处理粒球: 层级=6, 样本数=17, 纯度=1.00, 实际阈值=0.79

=== 训练后模型结构 ===
GranularThreeWayClassifier V3 (论文方法) 模型结构:
- 粒球模型: GranularBallV3
  * 最小纯度: 0.79
  * 粒球数量: 14
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.001
- 训练状态: 已训练
- 粒球统计:
  * 平均纯度: 0.94
  * 最小纯度: 0.80
  * 最大纯度: 1.00

=== 特征重要性 ===
[0.50100487 0.49899513]

=== 注意力矩阵 ===
[[ 0.25142283 -0.00927526]
 [-0.00927526  0.24940976]]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.8919
精确率: 0.9706
召回率: 0.7174
F1分数: 0.8250

=== 三支决策分布 ===
接受区域: 0.0%
拒绝区域: 27.8%
延迟决策: 72.2%
延迟决策准确率: 0.9893

混淆矩阵:
[[165   2]
 [ 26  66]]

=== 数据集mushroom ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\mushroom\mushroom.csv

=== 数据集详细信息 ===
总样本数: 8124
特征数: 22

=== 标签分布 ===
class
e    4208
p    3916
Name: count, dtype: int64

=== 特征统计 ===
       cap-shape cap-surface cap-color  ... spore-print-color population habitat
count       8124        8124      8124  ...              8124       8124    8124
unique         6           4        10  ...                 9          6       7
top            x           y         n  ...                 w          v       d
freq        3656        3244      2284  ...              2388       4040    3148

[4 rows x 22 columns]
=== 开始训练 ===

初始数据统计: 样本数=5686, 类别分布={0: 2945, 1: 2741}
处理粒球: 层级=0, 样本数=5686, 纯度=0.52, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=1, 样本数=3465, 纯度=0.83, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=1, 样本数=2221, 纯度=0.97, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=2, 样本数=900, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=2, 样本数=2565, 纯度=0.78, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=2, 样本数=916, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=2, 样本数=1305, 纯度=0.96, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=3, 样本数=2426, 纯度=0.76, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=3, 样本数=139, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=3, 样本数=1283, 纯度=0.96, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=3, 样本数=22, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=4, 样本数=1235, 纯度=0.53, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=4, 样本数=1191, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=4, 样本数=1278, 纯度=0.96, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=4, 样本数=5, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=5, 样本数=754, 纯度=0.77, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=5, 样本数=481, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=5, 样本数=809, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=5, 样本数=469, 纯度=0.88, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=6, 样本数=618, 纯度=0.71, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=6, 样本数=136, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=6, 样本数=444, 纯度=0.93, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=6, 样本数=25, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=7, 样本数=377, 纯度=0.71, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=7, 样本数=241, 纯度=0.71, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=7, 样本数=55, 纯度=0.56, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=7, 样本数=389, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=8, 样本数=322, 纯度=0.66, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=8, 样本数=55, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=8, 样本数=218, 纯度=0.79, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=8, 样本数=23, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=8, 样本数=43, 纯度=0.72, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=8, 样本数=12, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=9, 样本数=112, 纯度=0.96, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=9, 样本数=210, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=9, 样本数=172, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=9, 样本数=46, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=9, 样本数=26, 纯度=0.54, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=9, 样本数=17, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=10, 样本数=11, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=10, 样本数=101, 纯度=0.96, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=10, 样本数=14, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=10, 样本数=12, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=11, 样本数=30, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=11, 样本数=71, 纯度=0.94, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=12, 样本数=3, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=12, 样本数=68, 纯度=0.99, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=13, 样本数=58, 纯度=0.98, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=13, 样本数=10, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=14, 样本数=20, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=14, 样本数=38, 纯度=0.97, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=15, 样本数=19, 纯度=0.95, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=15, 样本数=19, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=16, 样本数=9, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=16, 样本数=10, 纯度=0.90, 实际阈值=0.99
--> 触发分裂
处理粒球: 层级=17, 样本数=1, 纯度=1.00, 实际阈值=0.99
处理粒球: 层级=17, 样本数=9, 纯度=1.00, 实际阈值=0.99

=== 训练后模型结构 ===
GranularThreeWayClassifier V3 (论文方法) 模型结构:
- 粒球模型: GranularBallV3
  * 最小纯度: 0.99
  * 粒球数量: 16
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.02
- 训练状态: 已训练
- 粒球统计:
  * 平均纯度: 0.98
  * 最小纯度: 0.87
  * 最大纯度: 1.00

=== 特征重要性 ===
[0.00895449 0.00918149 0.00798712 0.00871165 0.00862208 0.00798788
 0.00809652 0.0087283  0.00817028 0.0078965  0.00907437 0.00863147
 0.00852979 0.00852133 0.00803164 0.00908485 0.00916779 0.00917169
 0.00808111 0.00836148 0.00797725 0.00797725 0.00875167 0.00905938
 0.00833618 0.00897186 0.00877996 0.00780902 0.00903531 0.0087056
 0.00890636 0.0089463  0.0089463  0.00783655 0.00783655 0.00750606
 0.00750606 0.00840947 0.00910988 0.00884482 0.00885215 0.00897186
 0.00876868 0.00913263 0.00862089 0.00915922 0.00893923 0.0073623
 0.00900602 0.00779055 0.00779055 0.00801658 0.00789422 0.00875995
 0.00856779 0.00905938 0.00842206 0.00813212 0.00791866 0.00841506
 0.00824382 0.00829208 0.00785943 0.007726   0.0089561  0.00877996
 0.00911247 0.00891032 0.00866548 0.0090573  0.00844124 0.00797862
 0.00887064 0.0089604  0.00877996 0.00910564 0.00890982 0.00786566
 0.0090573  0.00854302 0.00791965 0.00840999 0.00918613 0.00910988
 0.00911074 0.00898011 0.00887064 0.00877996 0.00853484 0.0086455
 0.00795603 0.00860809 0.00858312 0.00877996 0.00791134 0.00914163
 0.00836035 0.0084325  0.00849158 0.00914267 0.00912318 0.00868689
 0.00757775 0.00914476 0.00897518 0.00817618 0.00896365 0.00870238
 0.00791109 0.00819081 0.00799791 0.00844188 0.00788814 0.0090171
 0.0085649  0.00868604 0.00905868]

=== 注意力矩阵 ===
[[ 8.01970803e-05 -4.54457727e-07 -1.36237306e-05 ... -6.96137151e-06
  -4.08790040e-06 -3.06638274e-06]
 [-4.54457727e-07  8.43146239e-05 -1.33428640e-06 ... -7.15730262e-07
  -4.00362433e-07 -3.00316626e-07]
 [-1.36237306e-05 -1.33428640e-06  6.38052503e-05 ...  1.43782305e-06
   1.22651914e-06 -3.05358085e-07]
 ...
 [-6.96137151e-06 -7.15730262e-07  1.43782305e-06 ...  7.33704865e-05
  -6.43807741e-06 -4.82927849e-06]
 [-4.08790040e-06 -4.00362433e-07  1.22651914e-06 ... -6.43807741e-06
   7.54605892e-05 -2.70138317e-06]
 [-3.06638274e-06 -3.00316626e-07 -3.05358085e-07 ... -4.82927849e-06
  -2.70138317e-06  8.20741521e-05]]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.8503
精确率: 1.0000
召回率: 0.6894
F1分数: 0.8161

=== 三支决策分布 ===
接受区域: 0.0%
拒绝区域: 21.5%
延迟决策: 78.5%
延迟决策准确率: 0.9101

混淆矩阵:
[[1263    0]
 [ 365  810]]

=== 数据集svmguide1 ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\svmguide1\svmguide1.csv

=== 数据集详细信息 ===
总样本数: 7089
特征数: 4

=== 标签分布 ===
label
1.0    4000
0.0    3089
Name: count, dtype: int64

=== 特征统计 ===
         feature_0    feature_1    feature_2    feature_3
count  7089.000000  7089.000000  7089.000000  7089.000000
mean     29.914873   102.707850     0.073753   111.833706
std      31.584115    94.408856     0.252143    40.215970
min       0.000000    -7.739998    -0.801620     5.649806
25%      15.029000    29.356990    -0.158071    86.488440
50%      21.384990    68.469190     0.134378   119.483600
75%      34.571010   154.176000     0.259976   143.664900
max     297.050000   581.073100     0.726092   180.000000
=== 开始训练 ===

初始数据统计: 样本数=4962, 类别分布={0: 2162, 1: 2800}
处理粒球: 层级=0, 样本数=4962, 纯度=0.56, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=1, 样本数=1260, 纯度=0.99, 实际阈值=0.80
处理粒球: 层级=1, 样本数=3702, 纯度=0.58, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=2, 样本数=1252, 纯度=0.52, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=2, 样本数=2450, 纯度=0.61, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=3, 样本数=471, 纯度=0.97, 实际阈值=0.80
处理粒球: 层级=3, 样本数=781, 纯度=0.74, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=3, 样本数=826, 纯度=0.92, 实际阈值=0.80
处理粒球: 层级=3, 样本数=1624, 纯度=0.55, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=4, 样本数=352, 纯度=0.52, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=4, 样本数=429, 纯度=0.93, 实际阈值=0.80
处理粒球: 层级=4, 样本数=910, 纯度=0.78, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=4, 样本数=714, 纯度=0.96, 实际阈值=0.80
处理粒球: 层级=5, 样本数=170, 纯度=0.89, 实际阈值=0.80
处理粒球: 层级=5, 样本数=182, 纯度=0.82, 实际阈值=0.80
处理粒球: 层级=5, 样本数=438, 纯度=0.71, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=5, 样本数=472, 纯度=0.84, 实际阈值=0.80
处理粒球: 层级=6, 样本数=156, 纯度=0.71, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=6, 样本数=282, 纯度=0.95, 实际阈值=0.80
处理粒球: 层级=7, 样本数=149, 纯度=0.74, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=7, 样本数=7, 纯度=0.86, 实际阈值=0.80
处理粒球: 层级=8, 样本数=50, 纯度=0.96, 实际阈值=0.80
处理粒球: 层级=8, 样本数=99, 纯度=0.63, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=9, 样本数=58, 纯度=0.88, 实际阈值=0.80
处理粒球: 层级=9, 样本数=41, 纯度=0.73, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=10, 样本数=24, 纯度=0.58, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=10, 样本数=17, 纯度=0.94, 实际阈值=0.80
处理粒球: 层级=11, 样本数=13, 纯度=0.69, 实际阈值=0.80
--> 触发分裂
处理粒球: 层级=11, 样本数=11, 纯度=0.91, 实际阈值=0.80
处理粒球: 层级=12, 样本数=2, 纯度=1.00, 实际阈值=0.80
处理粒球: 层级=12, 样本数=11, 纯度=0.82, 实际阈值=0.80

=== 训练后模型结构 ===
GranularThreeWayClassifier V3 (论文方法) 模型结构:
- 粒球模型: GranularBallV3
  * 最小纯度: 0.8
  * 粒球数量: 8
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 1e-05
- 训练状态: 已训练
- 粒球统计:
  * 平均纯度: 0.85
  * 最小纯度: 0.68
  * 最大纯度: 0.98

=== 特征重要性 ===
[0.28851036 0.28533784 0.20637307 0.21977873]

=== 注意力矩阵 ===
[[ 0.083255    0.05819794 -0.01312308  0.02954651]
 [ 0.05819794  0.0814341  -0.01391574  0.02939838]
 [-0.01312308 -0.01391574  0.04259843 -0.00082399]
 [ 0.02954651  0.02939838 -0.00082399  0.04831243]]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.7330
精确率: 0.9051
召回率: 0.5883
F1分数: 0.7131

=== 三支决策分布 ===
接受区域: 0.0%
拒绝区域: 29.6%
延迟决策: 70.4%
延迟决策准确率: 0.9206

混淆矩阵:
[[853  74]
 [494 706]]

进程已结束，退出代码为 0
