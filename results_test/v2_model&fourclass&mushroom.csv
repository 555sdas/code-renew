E:\liner\venv_dmge\Scripts\python.exe E:\徐兵鑫毕业论文\code-renew\experiments\v2_model_特征注意力机制.py
=== 数据集fourclass ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\fourclass\fourclass.csv

=== 数据集详细信息 ===
总样本数: 862
特征数: 2

=== 标签分布 ===
label
-1.0    555
 1.0    307
Name: count, dtype: int64

=== 特征统计 ===
                0           1
count  862.000000  862.000000
mean   100.061485  101.955916
std     48.988109   48.114608
min      8.000000   16.000000
25%     59.250000   58.000000
50%     99.000000  102.000000
75%    140.000000  145.000000
max    190.000000  187.000000
=== 开始训练 ===

=== 初始模型结构 ===
GranularThreeWayClassifier V2 (带注意力机制) 模型结构:
- 粒球模型: GranularBallV2
  * 粒球半径: 0.2
  * 粒球数量: 0
  * 注意力维度: 4
  * 学习率: 0.01
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.2
- 训练状态: 未训练

=== 训练后模型结构 ===
GranularThreeWayClassifier V2 (带注意力机制) 模型结构:
- 粒球模型: GranularBallV2
  * 粒球半径: 0.2
  * 粒球数量: 90
  * 注意力维度: 4
  * 学习率: 0.01
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.2
- 训练状态: 已训练
- 粒球统计:
  * 平均纯度: 0.97
  * 最小纯度: 0.56
  * 最大纯度: 1.00
- 特征重要性:
  * 最重要特征: 0
  * 最不重要特征: 1

训练完成！生成 90 个粒球
平均纯度: 0.97
特征重要性: [1.2144259960454908, 0.9536951671188686]

注意力矩阵:
[[1.4748305  0.96645131]
 [0.96645131 0.90953447]]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.9459
精确率: 0.9756
召回率: 0.8696
F1分数: 0.9195

=== 三支决策分布 ===
接受区域: 0.0%
拒绝区域: 12.7%
延迟决策: 87.3%
延迟决策准确率: 0.9912

混淆矩阵:
[[165   2]
 [ 12  80]]

=== 数据集mushroom ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\mushroom\mushroom.csv

=== 数据集详细信息 ===
总样本数: 8124
特征数: 22

=== 标签分布 ===
class
e    4208
p    3916
Name: count, dtype: int64

=== 特征统计 ===
       cap-shape cap-surface cap-color  ... spore-print-color population habitat
count       8124        8124      8124  ...              8124       8124    8124
unique         6           4        10  ...                 9          6       7
top            x           y         n  ...                 w          v       d
freq        3656        3244      2284  ...              2388       4040    3148

[4 rows x 22 columns]
训练集特征形状: (5686, 117)
测试集特征形状: (2438, 117)
=== 开始训练 ===

=== 初始模型结构 ===
GranularThreeWayClassifier V2 (带注意力机制) 模型结构:
- 粒球模型: GranularBallV2
  * 粒球半径: 4
  * 粒球数量: 0
  * 注意力维度: 10
  * 学习率: 0.001
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.2
- 训练状态: 未训练

=== 训练后模型结构 ===
GranularThreeWayClassifier V2 (带注意力机制) 模型结构:
- 粒球模型: GranularBallV2
  * 粒球半径: 4
  * 粒球数量: 86
  * 注意力维度: 10
  * 学习率: 0.001
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.2
- 训练状态: 已训练
- 粒球统计:
  * 平均纯度: 0.93
  * 最小纯度: 0.57
  * 最大纯度: 1.00
- 特征重要性:
  * 最重要特征: 83
  * 最不重要特征: 105

训练完成！生成 86 个粒球
平均纯度: 0.93
特征重要性: [0.4489198406291791, 0.4364719643189714, 0.38331368080775197, 0.2923731392528558, 0.4637317121097513, 0.43238583610798, 0.28769305000532247, 0.41824647018498556, 0.3920254226101417, 0.4173826339707589, 0.4697841683085005, 0.45714971693634365, 0.4043178985870639, 0.38508566741122174, 0.4492022471364629, 0.3052476835097121, 0.4118494915381521, 0.4421918500138698, 0.3886009738837438, 0.5055489942030208, 0.3819523786587166, 0.3816878286538364, 0.38623451336504006, 0.3576746584869836, 0.403461496113511, 0.4161216991313295, 0.4451899407923295, 0.4366469188635297, 0.36196053217499236, 0.4437015262660631, 0.4082732872146848, 0.45659081496071197, 0.4662588525035038, 0.40721929587287004, 0.4297144269637564, 0.45022414742750855, 0.32625423852781865, 0.37029912801343445, 0.43163537464810847, 0.4454105392393452, 0.365303468295949, 0.338499507959126, 0.3451162476524613, 0.37232284404320437, 0.36427153204630824, 0.4479222773380099, 0.4393409976581754, 0.374085726924587, 0.4643029741874304, 0.3814650674750855, 0.33287675214231377, 0.4061021304799923, 0.3781527598365441, 0.4899026752601898, 0.4192757681662057, 0.34995202677393367, 0.42550129668544007, 0.3261007041411838, 0.4553947994032262, 0.3828490846133371, 0.3549965381686485, 0.3622405035185274, 0.4458376083678291, 0.417563471978219, 0.39058742958632153, 0.34396149997760594, 0.443341115691995, 0.5135676153486907, 0.40954658314373543, 0.3883057574385544, 0.34296032463123255, 0.48920926089341976, 0.4377621838332615, 0.3944906650085393, 0.3455943872560524, 0.4406539823960026, 0.405677646741863, 0.408985143988411, 0.4203432861195278, 0.3475705148093963, 0.49728531668041775, 0.45391212522662, 0.392902623097626, 0.5521228256662015, 0.4349030308295717, 0.34190118009412424, 0.3670582042106416, 0.2736413279864589, 0.3150664650354946, 0.3798642108389625, 0.39113691788290783, 0.31354073317234843, 0.4022371743929556, 0.36817046489790867, 0.38252590340768405, 0.3180492161176231, 0.3227661505156238, 0.44640506739695174, 0.37097433972950433, 0.3998050133612751, 0.48242068289723533, 0.3688712356292615, 0.4075520643792297, 0.41660011962361027, 0.3860300026091087, 0.24125116352587783, 0.40100921253218186, 0.3574222475226073, 0.35126800749764986, 0.3869038141153053, 0.3871799317404413, 0.3105574846144442, 0.3977703165548213, 0.3462616895836393, 0.43683850794274737, 0.3616613047449862, 0.43351997826321065]

注意力矩阵:
[[ 0.20152902 -0.03189938  0.09691111 ...  0.07212983  0.04908226
   0.04146595]
 [-0.03189938  0.19050778 -0.05548224 ... -0.00149135 -0.00231055
  -0.02692748]
 [ 0.09691111 -0.05548224  0.14692938 ...  0.05659152  0.00405824
   0.00126368]
 ...
 [ 0.07212983 -0.00149135  0.05659152 ...  0.19082788  0.10694203
   0.02647729]
 [ 0.04908226 -0.00231055  0.00405824 ...  0.10694203  0.1307989
   0.02818782]
 [ 0.04146595 -0.02692748  0.00126368 ...  0.02647729  0.02818782
   0.18793957]]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.8897
精确率: 0.9594
召回率: 0.8051
F1分数: 0.8755

=== 三支决策分布 ===
接受区域: 0.0%
拒绝区域: 8.4%
延迟决策: 91.6%
延迟决策准确率: 0.9216

混淆矩阵:
[[1223   40]
 [ 229  946]]

=== 数据集svmguide1 ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\svmguide1\svmguide1.csv

=== 数据集详细信息 ===
总样本数: 7089
特征数: 4

=== 标签分布 ===
label
1.0    4000
0.0    3089
Name: count, dtype: int64

=== 特征统计 ===
         feature_0    feature_1    feature_2    feature_3
count  7089.000000  7089.000000  7089.000000  7089.000000
mean     29.914873   102.707850     0.073753   111.833706
std      31.584115    94.408856     0.252143    40.215970
min       0.000000    -7.739998    -0.801620     5.649806
25%      15.029000    29.356990    -0.158071    86.488440
50%      21.384990    68.469190     0.134378   119.483600
75%      34.571010   154.176000     0.259976   143.664900
max     297.050000   581.073100     0.726092   180.000000
训练集特征形状: (4962, 4)
测试集特征形状: (2127, 4)
=== 开始训练 ===

=== 初始模型结构 ===
GranularThreeWayClassifier V2 (带注意力机制) 模型结构:
- 粒球模型: GranularBallV2
  * 粒球半径: 1
  * 粒球数量: 0
  * 注意力维度: 6
  * 学习率: 0.01
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.1
- 训练状态: 未训练

=== 训练后模型结构 ===
GranularThreeWayClassifier V2 (带注意力机制) 模型结构:
- 粒球模型: GranularBallV2
  * 粒球半径: 1
  * 粒球数量: 111
  * 注意力维度: 6
  * 学习率: 0.01
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.1
- 训练状态: 已训练
- 粒球统计:
  * 平均纯度: 0.94
  * 最小纯度: 0.50
  * 最大纯度: 1.00
- 特征重要性:
  * 最重要特征: 0
  * 最不重要特征: 1

训练完成！生成 111 个粒球
平均纯度: 0.94
特征重要性: [1.363626542130499, 0.9402673995927883, 0.9798781976825888, 1.1870450109807393]

注意力矩阵:
[[ 1.85947735  0.43436126 -0.3913464  -0.32188338]
 [ 0.43436126  0.88410278  0.04741585  0.65860567]
 [-0.3913464   0.04741585  0.96016128  0.7612546 ]
 [-0.32188338  0.65860567  0.7612546   1.40907586]]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.9215
精确率: 0.9449
召回率: 0.9142
F1分数: 0.9293

=== 三支决策分布 ===
接受区域: 0.0%
拒绝区域: 1.3%
延迟决策: 98.7%
延迟决策准确率: 0.9290

混淆矩阵:
[[ 863   64]
 [ 103 1097]]

进程已结束，退出代码为 0
