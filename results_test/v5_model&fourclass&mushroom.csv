E:\liner\venv_dmge\Scripts\python.exe E:\徐兵鑫毕业论文\code-renew\experiments\v5_model_纯度+熵+注意力三重反馈.py
=== 数据集fourclass ===
找到数据文件: E:\徐兵鑫毕业论文\数据集\fourclass\fourclass.csv

=== 数据集详细信息 ===
总样本数: 862
特征数: 2

=== 标签分布 ===
label
-1.0    555
 1.0    307
Name: count, dtype: int64

=== 特征统计 ===
                0           1
count  862.000000  862.000000
mean   100.061485  101.955916
std     48.988109   48.114608
min      8.000000   16.000000
25%     59.250000   58.000000
50%     99.000000  102.000000
75%    140.000000  145.000000
max    190.000000  187.000000
=== 开始训练 ===
[ClassifierV5] 初始化: min_purity=0.9, max_entropy=0.7
base_radius=0.5, alpha=1, beta=0.001

[GranularBallV5] 初始化参数: min_purity=0.9, max_entropy=0.7
初始数据统计: 样本数=603, 特征数=2
类别分布: {0: 388, 1: 215}
全局纯度: 0.64, 全局熵: 0.94

=== 迭代 1 ===
当前粒球: 层级=0, 样本数=603
纯度=0.643, 熵=0.940, 注意力权重=[0.277, -0.206]
触发分裂
分裂为3个子粒球

=== 迭代 2 ===
当前粒球: 层级=1, 样本数=262
纯度=0.500, 熵=1.000, 注意力权重=[0.144, -0.295]
触发分裂
分裂为4个子粒球

=== 迭代 3 ===
当前粒球: 层级=1, 样本数=172
纯度=0.523, 熵=0.998, 注意力权重=[0.243, -0.498]
触发分裂
分裂为3个子粒球

=== 迭代 4 ===
当前粒球: 层级=1, 样本数=169
纯度=0.988, 熵=0.093, 注意力权重=[0.404, -0.254]
新增粒球: 中心=[-1.09309721  0.57618907], 半径=0.005, 密度=7932336.985

=== 迭代 5 ===
当前粒球: 层级=2, 样本数=71
纯度=0.648, 熵=0.936, 注意力权重=[0.120, -0.204]
触发分裂
分裂为3个子粒球

=== 迭代 6 ===
当前粒球: 层级=2, 样本数=80
纯度=0.988, 熵=0.097, 注意力权重=[0.130, -0.094]
新增粒球: 中心=[-0.82535602 -1.20993161], 半径=0.001, 密度=29915810.723

=== 迭代 7 ===
当前粒球: 层级=2, 样本数=35
纯度=0.686, 熵=0.898, 注意力权重=[0.132, -0.354]
触发分裂
分裂为3个子粒球

=== 迭代 8 ===
当前粒球: 层级=2, 样本数=76
纯度=0.789, 熵=0.742, 注意力权重=[0.183, -0.447]
触发分裂
分裂为3个子粒球

=== 迭代 9 ===
当前粒球: 层级=2, 样本数=63
纯度=0.841, 熵=0.631, 注意力权重=[0.239, -0.478]
新增粒球: 中心=[0.32799064 0.99156597], 半径=0.035, 密度=52330.559

=== 迭代 10 ===
当前粒球: 层级=2, 样本数=58
纯度=1.000, 熵=0.000, 注意力权重=[0.282, -0.593]
新增粒球: 中心=[1.100321   1.49001825], 半径=0.000, 密度=57999942.000

=== 迭代 11 ===
当前粒球: 层级=2, 样本数=51
纯度=0.569, 熵=0.986, 注意力权重=[0.163, -0.386]
触发分裂
分裂为3个子粒球

=== 迭代 12 ===
当前粒球: 层级=3, 样本数=22
纯度=1.000, 熵=0.000, 注意力权重=[0.138, -0.270]
新增粒球: 中心=[-0.03243019 -0.21302704], 半径=0.000, 密度=21999978.000

=== 迭代 13 ===
当前粒球: 层级=3, 样本数=26
纯度=1.000, 熵=0.000, 注意力权重=[0.084, -0.215]
新增粒球: 中心=[ 0.11173814 -0.78417028], 半径=0.000, 密度=25999974.000

=== 迭代 14 ===
当前粒球: 层级=3, 样本数=23
纯度=0.870, 熵=0.559, 注意力权重=[0.124, -0.156]
新增粒球: 中心=[-0.51642388 -0.58686625], 半径=0.007, 密度=453117.198

=== 迭代 15 ===
当前粒球: 层级=3, 样本数=11
纯度=1.000, 熵=0.000, 注意力权重=[0.118, -0.321]
新增粒球: 中心=[ 0.73990016 -0.29610242], 半径=0.000, 密度=10999989.000

=== 迭代 16 ===
当前粒球: 层级=3, 样本数=12
纯度=1.000, 熵=0.000, 注意力权重=[0.181, -0.490]
新增粒球: 中心=[ 1.55342147 -0.71147932], 半径=0.000, 密度=11999988.000

=== 迭代 17 ===
当前粒球: 层级=3, 样本数=12
纯度=1.000, 熵=0.000, 注意力权重=[0.168, -0.471]
新增粒球: 中心=[ 1.56371921 -0.42071549], 半径=0.000, 密度=11999988.000

=== 迭代 18 ===
当前粒球: 层级=3, 样本数=30
纯度=1.000, 熵=0.000, 注意力权重=[0.156, -0.414]
新增粒球: 中心=[ 0.76049564 -1.15800949], 半径=0.000, 密度=29999970.000

=== 迭代 19 ===
当前粒球: 层级=3, 样本数=16
纯度=1.000, 熵=0.000, 注意力权重=[0.107, -0.304]
新增粒球: 中心=[ 0.16322683 -1.47992659], 半径=0.000, 密度=15999984.000

=== 迭代 20 ===
当前粒球: 层级=3, 样本数=30
纯度=1.000, 熵=0.000, 注意力权重=[0.196, -0.485]
新增粒球: 中心=[ 1.26508481 -1.56300197], 半径=0.000, 密度=29999970.000

=== 迭代 21 ===
当前粒球: 层级=3, 样本数=22
纯度=1.000, 熵=0.000, 注意力权重=[0.160, -0.347]
新增粒球: 中心=[0.49275445 0.24388755], 半径=0.000, 密度=21999978.000

=== 迭代 22 ===
当前粒球: 层级=3, 样本数=8
纯度=1.000, 熵=0.000, 注意力权重=[0.171, -0.494]
新增粒球: 中心=[ 1.6152079  -0.10918282], 半径=0.000, 密度=7999992.000

=== 迭代 23 ===
当前粒球: 层级=3, 样本数=21
纯度=1.000, 熵=0.000, 注意力权重=[0.162, -0.459]
新增粒球: 中心=[1.37835992 0.43080715], 半径=0.000, 密度=20999979.000

=== 训练完成 ===
生成粒球数: 16
平均半径: 0.003
平均纯度: 0.980
平均熵: 0.086
覆盖样本数: 603/603

=== 训练后模型结构 ===
GranularThreeWayClassifier V5 (纯度+熵+注意力三重反馈) 模型结构:
- 粒球模型: GranularBallV5
  * 最小纯度: 0.9
  * 最大熵阈值: 0.7
  * 基础半径: 0.5
  * 粒球数量: 16
- 三支决策模型: ThreeWayDecisionV1
  * alpha(接受阈值): 1
  * beta(拒绝阈值): 0.001
- 粒球统计:
  * 平均纯度: 0.980
  * 平均熵: 0.086
  * 平均半径: 0.003

=== 特征重要性 ===
[0.50000001 0.50000001]

=== 注意力矩阵 ===
[[ 0.25041529 -0.00927529]
 [-0.00927529  0.25041529]]

=== 开始预测 ===

=== 评估结果 ===

=== 分类性能 ===
准确率: 0.6139
精确率: 0.4706
召回率: 0.6957
F1分数: 0.5614

=== 三支决策分布 ===
接受区域: 52.5%
拒绝区域: 45.6%
延迟决策: 1.9%
延迟决策准确率: 1.0000

混淆矩阵:
[[95 72]
 [28 64]]

进程已结束，退出代码为 0
